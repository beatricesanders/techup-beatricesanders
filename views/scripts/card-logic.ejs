<script>

// Load in database from server
var db = JSON.parse('<%-JSON.stringify(card_db)%>');

// Flip card animation 
function flipCard(card_no) {
    document.getElementById(card_no).classList.toggle("flipped");
    document.getElementById(card_no + '-q').classList.toggle("flipped");
    document.getElementById(card_no + '-footer').classList.toggle("flipped");

    setTimeout(function(){changeCard(card_no)},300);
}

// Get and print random card from database 
function changeCard(card_no) {

    // first get current card ids 
    var current_cards = document.querySelectorAll(".q-card .q-id");
    var card_ids = [];

    for(var i = 0; i < current_cards.length; i++) {
        card_ids[i] = current_cards[i].innerHTML ;
    };

    if (card_ids[0] == "blank") {// if first ID is blank,  get a random card 
        rand = Math.floor(Math.random()* "<%= card_db.length %>") ;
    } else { // otherwise, make sure card is not already on the board 
        do {
            rand = Math.floor(Math.random()* "<%= card_db.length %>") 
        } while (card_ids.includes(rand));
    }

    // fetch theme icon 
    //theme_icon = getThemeIcon(db[rand].theme)
    theme_icon = "";
    
    // fetch heat icon and heat colors 
    heat_icon = "<img class = 'theme-icon' src = 'images/heat_icons/heat_"+db[rand].heat+".svg'>"
    heat_colors = getHeatColors(db[rand].heat)

    //update text
    document.getElementById(card_no + '-q').innerHTML = db[rand].question;
    document.getElementById(card_no + '-heat').innerHTML = heat_icon;
    document.getElementById(card_no + '-theme').innerHTML = db[rand].theme + " "+ theme_icon;
    document.getElementById(card_no + '-id').innerHTML = db[rand].id;

    //Change colors
    document.getElementById(card_no).style.backgroundColor = heat_colors[1];
    document.getElementById(card_no + '-footer').style.backgroundColor = heat_colors[2];


}

// Load all cards
function loadAllCards(card_no) {
    changeCard('card1')
    changeCard('card2')
}


// switch function for theme icons
function getThemeIcon(theme) {

    var theme_icon = ""

    switch(theme) {
        case "Food":
            theme_icon = "<img class = 'theme-icon' src = 'images/food.svg'>";
            break;
        case "Nostalgia":
        theme_icon = "<img class = 'theme-icon' src = 'images/nostalgia.svg'>";
            break;
        case "Life & Career":
        theme_icon = "<img class = 'theme-icon' src = 'images/career.svg'>";
            break;
        case "Hobbies & Habits":
        theme_icon = "<img class = 'theme-icon' src = 'images/career.svg'>";
            break;
        default:
        theme_icon = "";
        };

    return(theme_icon);

}

// switch function for card colors
function getHeatColors(theme) {

var heat_colors = []

switch(theme) {
    case 1:
        heat_colors[1] = "#72a276";
        heat_colors[2] = "#517B54";
        break;
    case 2:
        heat_colors[1] = "#448C90";
        heat_colors[2] = "#346D6F";
        break;
    case 3:
        heat_colors[1] = "#D79784";
        heat_colors[2] = "#AF7A6E";
        break;
    };

return(heat_colors);

}

</script>
  

