<!-- IMPT! This ejs does NOT close the div. When inserting, please remember to include a -->
<!-- /div tag. This is because the final "Apply Filters" button (which you should also include) -->
<!-- has different functionality on different pages -->

<!-- Collapsible Button & container -->
<button type = "button" class="collapsible" >Open Filters</button>

<div class="content">

<!-- Filters -->
<div class = "about-container" style = "text-align: center; padding-top: 1em;">
  <p><em>All filters <span style = "color:#823982; font-weight: 500">selected</span> by default. Click on the relevant card packs or heat tags to de-select, and click again to re-select</em></p>
</div>

<div class="filter-container">
  <div class="filter-inner-container" id="filter-themes">
    <h3>Theme Packs</h3>
    <!-- Control buttons -->
    <div class="selector-btn-grp">
      <button type="button" onclick="allActive('theme')">Select All</button>
      <button type="button" onclick="noneActive('theme')">De-select All</button>
    </div>
    <!-- Theme Cards -->
    <div class = "filter-cards-grp">
      <div class="theme-wrapper" id="theme-cards">
        <% card_themes.forEach(theme => { %>
        <button
          type="button"
          class="card-btn active"
          onclick="toggleActive(this)"
        ><%= theme.theme %></button>
        <% }); %>
      </div>
    </div>
  </div>

  <div class="filter-inner-container" id="filter-heat">
    <h3>Heat Tags</h3>
    <!-- Control buttons -->
    <div class="selector-btn-grp">
      <button type="button" onclick="allActive('heat')">Select All</button>
      <button type="button" onclick="noneActive('heat')">De-select All</button>
    </div>

    <!-- Heat Cards -->
    <div class="filter-cards-grp" id="heat-cards">
      <button
        type="button"
        class="card-btn active"
        onclick="toggleActive(this)"
        id="heat-card-1"
      >
        <img src="images/heat_icons/heat_1.svg" />
      </button>
      <button
        type="button"
        class="card-btn active"
        onclick="toggleActive(this)"
        id="heat-card-2"
      >
        <img src="images/heat_icons/heat_2.svg" />
      </button>
      <button
        type="button"
        class="card-btn active"
        onclick="toggleActive(this)"
        id="heat-card-3"
      >
        <img src="images/heat_icons/heat_3.svg" />
      </button>
    </div>
    <a href="about/#about-heat-tag-ref">What is a heat tag?</a>
  </div>
</div>

<!-- Filter functionality -->
<script>
  function toggleActive(target) {
    if (target.classList.contains("active")) {
      target.classList.remove("active");
    } else {
      target.className += " active";
    }
  }

  function noneActive(val) {
    var ids = val + "-cards";
    var all_cards = document
      .getElementById(ids)
      .getElementsByClassName("card-btn");
    for (var i = 0; i < all_cards.length; i++) {
      if (all_cards[i].classList.contains("active")) {
        all_cards[i].classList.remove("active");
      }
    }
  }

  function allActive(val) {
    var ids = val + "-cards";
    var id = val + "-card";
    var all_cards = document
      .getElementById(ids)
      .getElementsByClassName("card-btn");
    for (var i = 0; i < all_cards.length; i++) {
      if (all_cards[i].classList.contains("active")) {
        all_cards[i].classList.remove("active");
      }
      all_cards[i].className += " active";
    }
  }
</script>

<!-- Collapsible functionality -->
<script>
  var coll = document.getElementsByClassName("collapsible");
  var i;
  
  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("open");
      var content = this.nextElementSibling;
      if (content.style.maxHeight){
        content.style.maxHeight = null;
      } else {
        content.style.maxHeight = content.scrollHeight + "px";
      }
    });
  }
  </script>